<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Auction Room - Live Bidding</title>
  <meta name="description" content="Live auction room with real-time bidding using MetaMask">
  <link rel="stylesheet" href="css/base.css">
  <link rel="stylesheet" href="css/auction.css">

</head>

<body>
  <div class="container">
    <header class="header">
      <h1 id="auctionTitle">ğŸ† Live Auction</h1>
      <div>
        <div id="timer">â€”</div>
        <div id="auctionStatus"></div>
        <div id="participantInfo">â€”</div>
        <a class="btn-leave" href="/" aria-label="Exit to Lobby">ğŸšª Exit</a>
      </div>
    </header>

    <main class="auction-layout">
      <!-- Item Details Section -->
      <!-- Displays the image and description of the item being auctioned -->
      <section class="auction-item-panel">
        <h2 id="itemTitle">Auction Item</h2>
        <img src="images/Etherwave.png" alt="Auction Item" class="item-image" loading="lazy" width="500" height="500"
          onerror="this.src='images/fallback-image.png'; this.alt='Image not available';">
        <div class="item-details">
          <h3>ğŸ“‹ Description</h3>
          <p id="itemDescription">
            Exclusive item with high historical value.
            A rare opportunity to own a unique digital artwork verified on the blockchain.
          </p>
        </div>
      </section>

      <!-- Bidding Panel Section -->
      <!-- Displays the leaderboard and bidding controls -->
      <aside class="bidding-panel">
        <div class="bid-history-header">
          <div class="bid-history-title">
            ğŸ† Leaderboard
            <span class="bid-count" id="bidCount">0</span>
          </div>
        </div>

        <!-- List of recent bids -->
        <ul id="bidList">
          <li class="no-bids">
            <div class="no-bids-icon">ğŸ”­</div>
            <p>No bidders yet.<br>Be the first!</p>
          </li>
        </ul>

        <!-- Container for dynamic bidding controls (Connect Wallet / Place Bid) -->
        <div id="bidActionBox" class="bid-action-box"></div>
      </aside>
    </main>
  </div>

  <!-- Template: Connect Wallet Panel -->
  <!-- Shown when user is in 'bid' mode but hasn't connected wallet yet -->
  <template id="connect-wallet-panel-template">
    <div class="connect-panel">
      <h3>ğŸ” Connect Wallet</h3>
      <p style="color: var(--gray-600); margin-bottom: 1.5rem; font-size: 0.95em;">
        Connect your MetaMask to start bidding
      </p>
      <button id="connectWalletBtn" class="btn" aria-label="Connect MetaMask Wallet">
        ğŸ¦Š Connect MetaMask
      </button>
      <small style="display: block; margin-top: 1rem; color: var(--gray-500); font-size: 0.85em;">
        Make sure you are connected to Sepolia Testnet
      </small>
    </div>
  </template>

  <!-- Template: Bidder Panel -->
  <!-- Shown when user has connected wallet and can place bids -->
  <template id="bidder-panel-template">
    <div class="bidder-panel">
      <h3>ğŸ’° Place Your Bid</h3>

      <div class="wallet-info" id="walletInfo" style="display: none;">
        <div class="wallet-icon">ğŸ‘›</div>
        <div class="wallet-details">
          <div class="wallet-label">Wallet Connected</div>
          <div class="wallet-address" id="connectedWallet">â€”</div>
        </div>
      </div>

      <div class="bid-input-group">
        <div class="bid-input-wrapper">
          <input id="bidAmount" type="number" step="0.0001" min="0.0001" placeholder="0.01"
            aria-label="Bid amount in ETH" autocomplete="off" />
        </div>
        <button id="bidButton" class="btn" aria-label="Place bid">
          ğŸ’¸ Place Bid
        </button>
      </div>

      <button id="withdrawButton" class="btn secondary" style="width: 100%; margin-top: 0.75rem;"
        aria-label="Withdraw bid">
        â†©ï¸ Withdraw
      </button>

      <p id="status" class="status-info"></p>

      <div
        style="margin-top: 1.5rem; padding: 1rem; background: var(--gray-50); border-radius: var(--radius); border-left: 3px solid var(--info);">
        <small style="color: var(--gray-600); line-height: 1.6;">
          <strong>ğŸ’¡ Tips:</strong><br>
          â€¢ First bid minimum: >0.0001 ETH<br>
          â€¢ Subsequent bids: total accumulated bid must exceed current highest bid<br>
          â€¢ You can place multiple bids to increase your total<br>
          â€¢ Use withdraw to retrieve all your bids
        </small>
      </div>
    </div>
  </template>

  <!-- Loading Overlay Template -->
  <div id="loadingOverlay" class="loading-overlay" style="display: none;">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <div class="loading-text" id="loadingText">Processing...</div>
    </div>
  </div>

  <!-- Toast Container -->
  <div id="toastContainer"></div>

  <!-- Scripts -->
  <!-- auth.js: Handles authentication logic -->
  <script src="js/auth.js"></script>
  <!-- ethers.js: Library for interacting with Ethereum blockchain -->
  <script src="https://unpkg.com/ethers@5.2.0/dist/ethers.umd.min.js"></script>
  <!-- socket.io: Library for real-time communication -->
  <script src="https://cdn.socket.io/4.5.2/socket.io.min.js"></script>
  <!-- auction.js: Handles auction logic, bidding, and updates -->
  <script src="js/auction.js"></script>
</body>

</html>