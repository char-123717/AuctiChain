<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Auction Room - Live Bidding</title>
  <meta name="description" content="Live auction room with real-time bidding using MetaMask">
  <link rel="stylesheet" href="css/base.css">
  <link rel="stylesheet" href="css/auction.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
  <div class="container">
    <header class="header">
      <div class="header-left">
        <h1 id="auctionTitle"><i class="fas fa-gavel"></i> Live Auction</h1>
      </div>
      <div class="header-center">
        <div id="timer"><i class="fas fa-clock"></i> --:--:--</div>
      </div>
      <div class="header-right">
        <div id="auctionStatus"></div>
        <div class="navbar-wallet-status" id="navbarWalletStatus">
          <div class="wallet-row">
            <i class="fas fa-wallet"></i>
            <span id="navbarWalletAddress">Not Connected</span>
          </div>
        </div>
        <a class="btn-leave" href="/buyer/dashboard.html">
          <i class="fas fa-arrow-left"></i> Back
        </a>
      </div>
    </header>

    <main class="auction-layout">
      <!-- Item Details Section -->
      <section class="auction-item-panel">
        <img id="itemImage" src="" alt="Auction Item" class="item-image" loading="lazy">

        <div class="item-details">
          <p id="itemDescription">Loading item details...</p>
        </div>
      </section>

      <!-- Bidding Panel Section -->
      <aside class="bidding-panel">
        <!-- Price Section -->
        <div class="starting-price-section">
          <div class="price-row">
            <span class="price-label"><i class="fas fa-tag"></i>  Starting Price</span>
            <span class="price-value" id="startingPrice">-- ETH</span>
          </div>
          <div class="price-row highlight">
            <span class="price-label" id="currentBidLabel"><i class="fas fa-fire"></i>  Current Highest Bid</span>
            <span class="price-value highest" id="currentHighestBid">-- ETH</span>
          </div>
          <!-- Highest Bidder Section (inside price section) -->
          <div class="bidder-section" id="highestBidderRow" style="display: none;">
            <span class="bidder-label"><i class="fas fa-user"></i> Current Highest Bidder</span>
            <span class="bidder-address" id="highestBidderAddress">--</span>
          </div>
        </div>

        <!-- Container for dynamic bidding controls (Connect Wallet / Place Bid) -->
        <div id="bidActionBox" class="bid-action-box"></div>
      </aside>
    </main>
  </div>

  <!-- Template: Bidder Panel -->
  <template id="bidder-panel-template">
    <div class="bidder-panel">
      <h3><i class="fas fa-coins"></i> Place Your Bid</h3>

      <div class="bid-input-group">
        <div class="bid-input-wrapper">
          <input id="bidAmount" type="number" step="0.001" min="0.001" placeholder="Enter bid (ETH)"
            aria-label="Bid amount in ETH" autocomplete="off" />
        </div>
        <button id="bidButton" class="btn" aria-label="Place bid">
          <i class="fas fa-paper-plane"></i> Bid
        </button>
      </div>

      <button id="withdrawButton" class="btn"
        style="width: 100%; margin-top: 0.75rem; background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%); box-shadow: 0 4px 15px rgba(34, 197, 94, 0.3);"
        aria-label="Withdraw bid">
        <i class="fas fa-undo"></i> Withdraw
      </button>

      <div class="tips-section">
        <small>
          <strong><i class="fas fa-lightbulb"></i> Tips:</strong><br>
          • Maximum 3 decimal places (e.g., 0.001)<br>
          • Your total bid must exceed current highest<br>
          • Use withdraw to retrieve all your bids<br>
          • <i class="fas fa-info-circle" style="color: #f59e0b;"></i> Withdraw penalty: <strong style="color: #f59e0b;">1.5%</strong> (min 0.0001 ETH)
        </small>
      </div>
    </div>
  </template>

  <!-- Loading Overlay -->
  <div id="loadingOverlay" class="loading-overlay" style="display: none;">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <div class="loading-text" id="loadingText">Processing...</div>
    </div>
  </div>

  <!-- Toast Container -->
  <div id="toastContainer"></div>

  <!-- Scripts -->
  <script src="js/auth.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
  <script src="https://cdn.socket.io/4.5.2/socket.io.min.js"></script>
  <script src="js/auction.js"></script>
</body>

</html>